# タスクリスト - 欠席連絡システム

## タスク分類
- 🔵 Phase 2: 基盤構築
- 🟢 Phase 3: 管理者機能
- 🟡 Phase 4: 保護者機能  
- 🟣 Phase 5: フロントエンド
- 🔴 Phase 6: テスト・調整

---

## 🔵 Phase 2: 基盤構築

### タスク2-1: データベース環境設定 [✓]
- **優先度**: 最高
- **見積**: 30分
- **内容**:
  - [✓] .envファイルのDB設定をSQLiteに変更
  - [✓] database/database.sqliteファイル作成
  - [✓] config/database.phpの確認
- **完了条件**: SQLite接続が正常に動作する

### タスク2-2: マイグレーションファイル作成 [✓]
- **優先度**: 最高
- **見積**: 1時間
- **依存**: タスク2-1
- **内容**:
  - [✓] create_admins_tableマイグレーション作成
  - [✓] create_classes_tableマイグレーション作成
  - [✓] create_students_tableマイグレーション作成
  - [✓] create_parents_tableマイグレーション作成
  - [✓] create_absences_tableマイグレーション作成
  - [✓] create_two_factor_codes_tableマイグレーション作成
- **完了条件**: 全マイグレーションファイルが作成され、php -l で構文エラーがない

### タスク2-3: マイグレーション実行とテーブル確認 [✓]
- **優先度**: 最高
- **見積**: 15分
- **依存**: タスク2-2
- **内容**:
  - [✓] php artisan migrate実行
  - [✓] テーブル作成確認
  - [✓] 外部キー制約の確認
- **完了条件**: 全テーブルが正常に作成される

### タスク2-4: Modelクラス作成 [✓]
- **優先度**: 高
- **見積**: 45分
- **依存**: タスク2-3
- **内容**:
  - [✓] Adminモデル作成（認証用Authenticatableトレイト含む）
  - [✓] ClassModelモデル作成
  - [✓] Studentモデル作成
  - [✓] ParentModelモデル作成（認証用Authenticatableトレイト含む）
  - [✓] Absenceモデル作成
  - [✓] TwoFactorCodeモデル作成
  - [✓] 各モデルにリレーション定義
- **完了条件**: 全モデルが作成され、php -l で構文エラーがない

### タスク2-5: 認証ガード設定 [✓]
- **優先度**: 高
- **見積**: 30分
- **依存**: タスク2-4
- **内容**:
  - [✓] config/auth.phpにadminガード追加
  - [✓] config/auth.phpにparentガード追加
  - [✓] プロバイダー設定
- **完了条件**: ガード設定が正しく反映される

### タスク2-6: ミドルウェア作成 [✓]
- **優先度**: 高
- **見積**: 45分
- **依存**: タスク2-5
- **内容**:
  - [✓] AdminAuthミドルウェア作成
  - [✓] ParentAuthミドルウェア作成
  - [✓] TwoFactorVerifiedミドルウェア作成
  - [✓] app/Http/Kernel.phpに登録
- **完了条件**: 全ミドルウェアが作成され、php -l で構文エラーがない

### タスク2-7: 2段階認証サービス作成 [✓]
- **優先度**: 中
- **見積**: 1時間
- **依存**: タスク2-4
- **内容**:
  - [✓] TwoFactorServiceクラス作成
  - [✓] コード生成メソッド実装
  - [✓] コード検証メソッド実装
  - [✓] コード削除メソッド実装
- **完了条件**: サービスが作成され、php -l で構文エラーがない

### タスク2-8: メール設定 [✓]
- **優先度**: 中
- **見積**: 30分
- **内容**:
  - [✓] .envにメール設定追加（開発環境はlog）
  - [✓] config/mail.phpの確認
  - [✓] 2段階認証メールテンプレート作成
- **完了条件**: メール送信設定が完了する

---

## 🟢 Phase 3: 管理者機能

### タスク3-1: 管理者認証コントローラー作成 [✓]
- **優先度**: 高
- **見積**: 1時間
- **依存**: タスク2-6, タスク2-7
- **内容**:
  - [✓] AdminLoginController作成
  - [✓] ログインメソッド実装
  - [✓] ログアウトメソッド実装
  - [✓] 2FA検証メソッド実装
- **完了条件**: コントローラーが作成され、php -l で構文エラーがない

### タスク3-2: クラス管理機能 [✓]
- **優先度**: 高
- **見積**: 1.5時間
- **依存**: タスク2-4, タスク3-1
- **内容**:
  - [✓] ClassController作成
  - [✓] index（一覧）メソッド実装
  - [✓] store（登録）メソッド実装
  - [✓] show（詳細）メソッド実装
  - [✓] update（更新）メソッド実装
  - [✓] destroy（削除）メソッド実装
  - [✓] StoreClassRequestバリデーション作成
  - [✓] UpdateClassRequestバリデーション作成
- **完了条件**: CRUD機能が実装され、php -l で構文エラーがない

### タスク3-3: 生徒管理機能 [✓]
- **優先度**: 高
- **見積**: 1.5時間
- **依存**: タスク3-2
- **内容**:
  - [✓] StudentController作成
  - [✓] index（一覧）メソッド実装（クラス情報含む）
  - [✓] store（登録）メソッド実装
  - [✓] show（詳細）メソッド実装
  - [✓] update（更新）メソッド実装
  - [✓] destroy（削除）メソッド実装
  - [✓] StoreStudentRequestバリデーション作成
  - [✓] UpdateStudentRequestバリデーション作成
- **完了条件**: CRUD機能が実装され、php -l で構文エラーがない

### タスク3-4: 保護者管理機能 [✓]
- **優先度**: 高
- **見積**: 1.5時間
- **依存**: タスク3-3
- **内容**:
  - [✓] ParentController作成
  - [✓] index（一覧）メソッド実装（生徒情報含む）
  - [✓] store（登録）メソッド実装（初期パスワード生成）
  - [✓] show（詳細）メソッド実装
  - [✓] update（更新）メソッド実装
  - [✓] destroy（削除）メソッド実装
  - [✓] StoreParentRequestバリデーション作成
  - [✓] UpdateParentRequestバリデーション作成
- **完了条件**: CRUD機能が実装され、php -l で構文エラーがない

### タスク3-5: CSVインポートサービス作成 [✓]
- **優先度**: 中
- **見積**: 2時間
- **依存**: タスク3-3, タスク3-4
- **内容**:
  - [✓] CsvImportServiceクラス作成
  - [✓] CSVパースメソッド実装
  - [✓] データバリデーションメソッド実装
  - [✓] 生徒インポートメソッド実装
  - [✓] クラスインポートメソッド実装
  - [✓] 教員（クラス更新）インポートメソッド実装
- **完了条件**: サービスが作成され、php -l で構文エラーがない

### タスク3-6: CSVインポートコントローラー作成 [✓]
- **優先度**: 中
- **見積**: 1時間
- **依存**: タスク3-5
- **内容**:
  - [✓] ImportController作成
  - [✓] importStudentsメソッド実装
  - [✓] importClassesメソッド実装
  - [✓] importTeachersメソッド実装
  - [✓] ファイルバリデーション実装
- **完了条件**: コントローラーが作成され、php -l で構文エラーがない

### タスク3-7: 管理者ルート定義
- **優先度**: 高
- **見積**: 30分
- **依存**: タスク3-1〜3-6
- **内容**:
  - [ ] routes/api.phpに管理者ルート追加
  - [ ] ミドルウェア適用
  - [ ] プレフィックス設定（/api/admin）
- **完了条件**: 全ルートが定義され、ルートリストで確認できる

---

## 🟡 Phase 4: 保護者機能

### タスク4-1: 保護者認証コントローラー作成
- **優先度**: 高
- **見積**: 1時間
- **依存**: タスク2-6, タスク2-7
- **内容**:
  - [ ] ParentLoginController作成
  - [ ] ログインメソッド実装
  - [ ] ログアウトメソッド実装
  - [ ] 2FA検証メソッド実装
  - [ ] 初回パスワード変更チェック
- **完了条件**: コントローラーが作成され、php -l で構文エラーがない

### タスク4-2: 欠席連絡管理機能
- **優先度**: 高
- **見積**: 1.5時間
- **依存**: タスク4-1
- **内容**:
  - [ ] AbsenceController作成
  - [ ] index（一覧）メソッド実装（自分の子供のみ）
  - [ ] store（登録）メソッド実装
  - [ ] show（詳細）メソッド実装
  - [ ] update（更新）メソッド実装
  - [ ] destroy（削除）メソッド実装
  - [ ] StoreAbsenceRequestバリデーション作成
  - [ ] UpdateAbsenceRequestバリデーション作成
- **完了条件**: CRUD機能が実装され、php -l で構文エラーがない

### タスク4-3: 保護者ルート定義
- **優先度**: 高
- **見積**: 15分
- **依存**: タスク4-1, タスク4-2
- **内容**:
  - [ ] routes/api.phpに保護者ルート追加
  - [ ] ミドルウェア適用
  - [ ] プレフィックス設定（/api/parent）
- **完了条件**: 全ルートが定義され、ルートリストで確認できる

---

## 🟣 Phase 5: フロントエンド

### タスク5-1: Vue.js環境構築
- **優先度**: 最高
- **見積**: 1時間
- **内容**:
  - [ ] Vue 3インストール（npm install vue@next）
  - [ ] Vue Routerインストール
  - [ ] Piniaインストール
  - [ ] Axiosインストール
  - [ ] vite.config.jsにVueプラグイン設定
  - [ ] resources/js/app.jsをVue用に設定
- **完了条件**: Vue.jsが正常に動作する

### タスク5-2: Tailwind CSS設定
- **優先度**: 最高
- **見積**: 30分
- **依存**: タスク5-1
- **内容**:
  - [ ] Tailwind CSSインストール
  - [ ] postcss.config.js設定
  - [ ] tailwind.config.js設定
  - [ ] resources/css/app.cssにTailwindディレクティブ追加
- **完了条件**: Tailwind CSSが正常に適用される

### タスク5-3: ルーター設定
- **優先度**: 高
- **見積**: 45分
- **依存**: タスク5-1
- **内容**:
  - [ ] resources/js/router/index.js作成
  - [ ] 管理者ルート定義
  - [ ] 保護者ルート定義
  - [ ] ナビゲーションガード設定
- **完了条件**: ルーティングが正常に動作する

### タスク5-4: Pinia Store作成
- **優先度**: 高
- **見積**: 1時間
- **依存**: タスク5-1
- **内容**:
  - [ ] stores/auth.js作成（認証状態管理）
  - [ ] stores/admin.js作成（管理者機能状態管理）
  - [ ] stores/parent.js作成（保護者機能状態管理）
- **完了条件**: 全storeが作成され、動作する

### タスク5-5: 共通コンポーネント作成
- **優先度**: 高
- **見積**: 2時間
- **依存**: タスク5-2
- **内容**:
  - [ ] Header.vue作成（レスポンシブ対応）
  - [ ] Footer.vue作成
  - [ ] Modal.vue作成
  - [ ] Table.vue作成（ソート・ページネーション対応）
  - [ ] Button.vue作成
  - [ ] Input.vue作成
  - [ ] Select.vue作成
- **完了条件**: 全コンポーネントが作成され、レスポンシブ対応している

### タスク5-6: レイアウトコンポーネント作成
- **優先度**: 高
- **見積**: 1時間
- **依存**: タスク5-5
- **内容**:
  - [ ] AdminLayout.vue作成
  - [ ] ParentLayout.vue作成
  - [ ] GuestLayout.vue作成
- **完了条件**: 全レイアウトが作成され、動作する

### タスク5-7: 認証画面コンポーネント作成
- **優先度**: 高
- **見積**: 2時間
- **依存**: タスク5-5, タスク5-6
- **内容**:
  - [ ] AdminLogin.vue作成
  - [ ] ParentLogin.vue作成
  - [ ] TwoFactorVerify.vue作成
  - [ ] フォームバリデーション実装
- **完了条件**: 認証画面が正常に動作する

### タスク5-8: 管理者画面 - クラス管理
- **優先度**: 高
- **見積**: 2時間
- **依存**: タスク5-5, タスク5-6
- **内容**:
  - [ ] ClassList.vue作成（一覧・削除）
  - [ ] ClassForm.vue作成（登録・編集）
  - [ ] バリデーション実装
  - [ ] レスポンシブ対応
- **完了条件**: クラス管理画面が正常に動作する

### タスク5-9: 管理者画面 - 生徒管理
- **優先度**: 高
- **見積**: 2時間
- **依存**: タスク5-8
- **内容**:
  - [ ] StudentList.vue作成（一覧・削除・検索）
  - [ ] StudentForm.vue作成（登録・編集）
  - [ ] クラス選択機能実装
  - [ ] バリデーション実装
  - [ ] レスポンシブ対応
- **完了条件**: 生徒管理画面が正常に動作する

### タスク5-10: 管理者画面 - 保護者管理
- **優先度**: 高
- **見積**: 2時間
- **依存**: タスク5-9
- **内容**:
  - [ ] ParentList.vue作成（一覧・削除・検索）
  - [ ] ParentForm.vue作成（登録・編集）
  - [ ] 生徒選択機能実装
  - [ ] 初期パスワード表示機能
  - [ ] バリデーション実装
  - [ ] レスポンシブ対応
- **完了条件**: 保護者管理画面が正常に動作する

### タスク5-11: 管理者画面 - CSVインポート
- **優先度**: 中
- **見積**: 2時間
- **依存**: タスク5-5, タスク5-6
- **内容**:
  - [ ] CsvImport.vue作成
  - [ ] ファイル選択機能実装
  - [ ] プレビュー表示機能実装
  - [ ] インポート種別選択（生徒/クラス/教員）
  - [ ] エラー表示機能実装
  - [ ] レスポンシブ対応
- **完了条件**: CSVインポート画面が正常に動作する

### タスク5-12: 保護者画面 - 欠席連絡管理
- **優先度**: 高
- **見積**: 2.5時間
- **依存**: タスク5-5, タスク5-6
- **内容**:
  - [ ] AbsenceList.vue作成（一覧・削除）
  - [ ] AbsenceForm.vue作成（登録・編集）
  - [ ] 欠席/遅刻区分切替実装
  - [ ] 日付ピッカー実装
  - [ ] 時刻ピッカー実装（遅刻時のみ）
  - [ ] バリデーション実装
  - [ ] レスポンシブ対応
- **完了条件**: 欠席連絡管理画面が正常に動作する

### タスク5-13: ビルドとデプロイ設定
- **優先度**: 中
- **見積**: 30分
- **依存**: タスク5-1〜5-12
- **内容**:
  - [ ] npm run buildでビルド確認
  - [ ] public/build配下のファイル確認
  - [ ] Laravelビュー（resources/views/app.blade.php）作成
  - [ ] @viteディレクティブ設定
- **完了条件**: ビルドが正常に完了し、画面が表示される

---

## 🔴 Phase 6: テスト・調整

### タスク6-1: シーダー作成
- **優先度**: 中
- **見積**: 1時間
- **内容**:
  - [ ] AdminSeeder作成（管理者ユーザー）
  - [ ] ClassSeeder作成（テストクラス）
  - [ ] StudentSeeder作成（テスト生徒）
  - [ ] ParentSeeder作成（テスト保護者）
  - [ ] DatabaseSeederに登録
- **完了条件**: php artisan db:seedでテストデータが投入される

### タスク6-2: 機能テスト作成
- **優先度**: 中
- **見積**: 3時間
- **内容**:
  - [ ] 管理者認証テスト作成
  - [ ] 保護者認証テスト作成
  - [ ] 生徒CRUD テスト作成
  - [ ] 保護者CRUD テスト作成
  - [ ] クラスCRUD テスト作成
  - [ ] 欠席連絡CRUD テスト作成
  - [ ] CSVインポートテスト作成
  - [ ] 権限チェックテスト作成
- **完了条件**: php artisan testで全テストがパスする

### タスク6-3: バリデーションテスト
- **優先度**: 中
- **見積**: 2時間
- **内容**:
  - [ ] 各Requestクラスのバリデーションテスト作成
  - [ ] エラーメッセージ確認
  - [ ] 境界値テスト
- **完了条件**: 全バリデーションが正常に動作する

### タスク6-4: 2段階認証テスト
- **優先度**: 高
- **見積**: 1時間
- **内容**:
  - [ ] コード生成テスト
  - [ ] コード検証テスト
  - [ ] コード有効期限テスト
  - [ ] メール送信テスト
- **完了条件**: 2段階認証が正常に動作する

### タスク6-5: UIテスト
- **優先度**: 低
- **見積**: 2時間
- **内容**:
  - [ ] レスポンシブデザイン確認（各デバイス）
  - [ ] フォーム入力確認
  - [ ] エラー表示確認
  - [ ] ナビゲーション確認
- **完了条件**: 全画面がレスポンシブ対応している

### タスク6-6: パフォーマンステスト
- **優先度**: 低
- **見積**: 1時間
- **内容**:
  - [ ] N+1問題確認（Laravel Debugbar使用）
  - [ ] ページロード時間測定
  - [ ] 大量データでの動作確認
- **完了条件**: パフォーマンス基準を満たす

### タスク6-7: セキュリティチェック
- **優先度**: 高
- **見積**: 1時間
- **内容**:
  - [ ] CSRF保護確認
  - [ ] XSS対策確認
  - [ ] SQLインジェクション対策確認
  - [ ] 認証・認可チェック
  - [ ] パスワードハッシュ化確認
- **完了条件**: セキュリティ要件を満たす

### タスク6-8: ドキュメント作成
- **優先度**: 低
- **見積**: 2時間
- **内容**:
  - [ ] README.md更新（セットアップ手順）
  - [ ] API仕様書作成
  - [ ] CSVフォーマット仕様書作成
  - [ ] 運用マニュアル作成
- **完了条件**: 必要なドキュメントが揃う

---

## タスク実行順序（推奨）

### Week 1: 基盤構築
1. タスク2-1 → タスク2-2 → タスク2-3 （データベース）
2. タスク2-4 → タスク2-5 → タスク2-6 （認証基盤）
3. タスク2-7 → タスク2-8 （2段階認証・メール）

### Week 2: バックエンド実装
4. タスク3-1 （管理者認証）
5. タスク3-2 → タスク3-3 → タスク3-4 （CRUD機能）
6. タスク3-5 → タスク3-6 （CSVインポート）
7. タスク3-7 （ルート定義）
8. タスク4-1 → タスク4-2 → タスク4-3 （保護者機能）

### Week 3-4: フロントエンド実装
9. タスク5-1 → タスク5-2 （環境構築）
10. タスク5-3 → タスク5-4 （ルーター・Store）
11. タスク5-5 → タスク5-6 （共通コンポーネント）
12. タスク5-7 （認証画面）
13. タスク5-8 → タスク5-9 → タスク5-10 → タスク5-11 （管理者画面）
14. タスク5-12 （保護者画面）
15. タスク5-13 （ビルド設定）

### Week 5: テスト・調整
16. タスク6-1 （シーダー）
17. タスク6-2 → タスク6-3 （機能テスト）
18. タスク6-4 （2段階認証テスト）
19. タスク6-7 （セキュリティチェック）
20. タスク6-5 → タスク6-6 （UI・パフォーマンス）
21. タスク6-8 （ドキュメント）

---

## 進捗管理

### 凡例
- [ ] 未着手
- [進行中] 作業中
- [✓] 完了
- [保留] 一時保留
- [×] スキップ

### 現在の進捗
- Phase 1: 100% 完了 ✓
- Phase 2: 0%
- Phase 3: 0%
- Phase 4: 0%
- Phase 5: 0%
- Phase 6: 0%

**全体進捗: 0/52 タスク完了 (0%)**

---

## 注意事項

1. **各タスク実行前に必ずphp -l でPHP構文チェックを実施**
2. **データベース操作後は必ずマイグレーション状態を確認**
3. **コントローラー作成後は必ずルート定義を確認**
4. **フロントエンド実装時は必ずレスポンシブ対応を確認**
5. **セキュリティに関わる実装は特に慎重に**
6. **エラーが発生した場合は次に進まず、必ず解決してから進む**
7. **想定外の問題が発生した場合は、ユーザーに報告し指示を仰ぐ**

## 次のステップ

タスク化が完了しました。
実行フェーズへ進む前に、以下を確認してください：

1. タスクの粒度は適切か
2. 依存関係は正しいか
3. 見積時間は妥当か
4. 優先順位は適切か
5. 実行順序に問題はないか
